"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "main";
exports.ids = null;
exports.modules = {

/***/ "./src/plugins/scaffolder/actions/cloudbees-insiel.ts":
/*!************************************************************!*\
  !*** ./src/plugins/scaffolder/actions/cloudbees-insiel.ts ***!
  \************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"createCloudbeesInsielAction\": () => (/* binding */ createCloudbeesInsielAction)\n/* harmony export */ });\n/* harmony import */ var _backstage_plugin_scaffolder_backend__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @backstage/plugin-scaffolder-backend */ \"../../plugins/scaffolder-backend/src/index.ts\");\n/* harmony import */ var _backstage_backend_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @backstage/backend-common */ \"../backend-common/src/index.ts\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! axios */ \"axios\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var https__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! https */ \"https\");\n/* harmony import */ var https__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(https__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! uuid */ \"uuid\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(uuid__WEBPACK_IMPORTED_MODULE_4__);\n/* module decorator */ module = __webpack_require__.hmd(module);\n(function () { var enterModule = (__webpack_require__(/*! react-hot-loader */ \"react-hot-loader\").enterModule); enterModule && enterModule(module); })();/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n\nconst git = __webpack_require__(/*! isomorphic-git */ \"isomorphic-git?7761\");\nconst http = __webpack_require__(/*! isomorphic-git/http/node */ \"isomorphic-git/http/node?5755\");\nconst fs = __webpack_require__(/*! fs */ \"fs\");\nconst path = __webpack_require__(/*! path */ \"path\");\nconst nunjucks = __webpack_require__(/*! nunjucks */ \"nunjucks\");\n\n\n\n\n// const util = require('util');\n\nconst createCloudbeesInsielAction = (options) => {\n  const { config } = options;\n\n  return (0,_backstage_plugin_scaffolder_backend__WEBPACK_IMPORTED_MODULE_0__.createTemplateAction)\n\n\n\n({\n    id: 'krateo:cloudbees-insiel',\n    schema: {\n      input: {\n        required: ['host', 'component_id', 'masterName'],\n        type: 'object',\n        properties: {\n          host: {\n            type: 'string',\n            title: 'Host',\n            description: 'Host',\n          },\n          component_id: {\n            type: 'string',\n            title: 'Component Id',\n            description: 'Component Id',\n          },\n          masterName: {\n            type: 'string',\n            title: 'Cloudbees node name',\n            description: 'node name',\n          },\n          gitHubUrl: {\n            type: 'string',\n            title: 'GitHub Url',\n            description: 'GitHub Url',\n          },\n        },\n      },\n    },\n    async handler(ctx) {\n      const fullUrl = `https://${ctx.input.host}`;\n      const url = new URL(fullUrl);\n      const owner = url.searchParams.get('owner');\n      const repo = url.searchParams.get('repo');\n      const base = url.origin;\n      const repoURL = `${base}/${owner}/${repo}`;\n\n      const templateUrl = ctx.templateInfo?.baseUrl.replace('/tree/main/', '');\n\n      const workDir = await ctx.createTemporaryDirectory();\n      const cbDir = (0,_backstage_backend_common__WEBPACK_IMPORTED_MODULE_1__.resolveSafeChildPath)(workDir, 'cloudbees');\n\n      ctx.logger.info(`Created temporary directory: ${workDir}`);\n      ctx.logger.info(`Cloudbees directory: ${cbDir}`);\n\n      await git.clone({\n        fs,\n        http,\n        dir: workDir,\n        url: templateUrl,\n        onAuth: () => ({ username: process.env.GITHUB_TOKEN }),\n        ref: 'main',\n        singleBranch: true,\n        depth: 1,\n      });\n\n      nunjucks.configure(cbDir, {\n        noCache: true,\n        autoescape: true,\n        tags: { variableStart: '${{' },\n      });\n\n      const appXml = path.join(cbDir, 'app.xml');\n      const helmXml = path.join(cbDir, 'helm-chart.xml');\n\n      // App\n      const appModified = nunjucks.render(appXml, {\n        owner,\n        repo,\n        gitHubUrl: ctx.input.gitHubUrl,\n        guid: (0,uuid__WEBPACK_IMPORTED_MODULE_4__.v4)(),\n      });\n      fs.writeFileSync(appXml, appModified, { encoding: 'utf-8' });\n      ctx.logger.info(`Created app.xml`);\n\n      // Helm Chart\n      const helmModified = nunjucks.render(helmXml, {\n        owner,\n        gitHubUrl: ctx.input.gitHubUrl,\n        repo: `${repo}-hc`,\n        guid: (0,uuid__WEBPACK_IMPORTED_MODULE_4__.v4)(),\n      });\n      fs.writeFileSync(helmXml, helmModified, { encoding: 'utf-8' });\n      ctx.logger.info(`Created helm-chart.xml`);\n\n      // calls\n      const axiosInstance = axios__WEBPACK_IMPORTED_MODULE_2___default().create({\n        httpsAgent: new https__WEBPACK_IMPORTED_MODULE_3__.Agent({\n          rejectUnauthorized: false,\n        }),\n      });\n\n      const instances = config.get('jenkins.instances');\n      const cb = instances.find(i => i.name === ctx.input.masterName);\n\n      const token = `${cb.username}:${cb.apiKey}`;\n      // app\n      //  data: Buffer.from(fs.readFileSync(appXml)),\n\n      ctx.logger.info(\n        `${JSON.stringify(\n          {\n            Accept: '*/*',\n            'Content-Type': `text/xml`,\n            Authorization: `Basic ${Buffer.from(token).toString('base64')}`,\n          },\n          null,\n          4,\n        )}`,\n      );\n\n      ctx.logger.info(`token: ${token}`);\n      ctx.logger.info(\n        `url: ${cb.baseUrl}/createItem?name=${ctx.input.component_id}`,\n      );\n      await axiosInstance({\n        method: 'post',\n        url: `${cb.baseUrl}/createItem?name=${ctx.input.component_id}`,\n        data: Buffer.from(fs.readFileSync(appXml)),\n        headers: {\n          Accept: '*/*',\n          'Content-Type': `text/xml`,\n          Authorization: `Basic ${Buffer.from(token).toString('base64')}`,\n        },\n      });\n      ctx.logger.info(`App pipeline created`);\n      // helm\n      await axiosInstance({\n        method: 'post',\n        url: `${cb.baseUrl}/createItem?name=${ctx.input.component_id}-hc`,\n        data: Buffer.from(fs.readFileSync(helmXml)),\n        headers: {\n          Accept: '*/*',\n          'Content-Type': `text/xml`,\n          Authorization: `Basic ${Buffer.from(token).toString('base64')}`,\n        },\n      });\n      ctx.logger.info(`Helm Chart pipeline created`);\n\n      ctx.logger.info(`All done successfully!`);\n    },\n  });\n};\n\n;(function () {\n  var reactHotLoader = (__webpack_require__(/*! react-hot-loader */ \"react-hot-loader\")[\"default\"]);\n  var leaveModule = (__webpack_require__(/*! react-hot-loader */ \"react-hot-loader\").leaveModule);\n  if (!reactHotLoader) {\n    return;\n  }\n  reactHotLoader.register(git, \"git\", \"/Users/maurosala/Dev/github/krateoplatformops/krateo-dashboard-backend/packages/backend/src/plugins/scaffolder/actions/cloudbees-insiel.ts\");\n  reactHotLoader.register(http, \"http\", \"/Users/maurosala/Dev/github/krateoplatformops/krateo-dashboard-backend/packages/backend/src/plugins/scaffolder/actions/cloudbees-insiel.ts\");\n  reactHotLoader.register(fs, \"fs\", \"/Users/maurosala/Dev/github/krateoplatformops/krateo-dashboard-backend/packages/backend/src/plugins/scaffolder/actions/cloudbees-insiel.ts\");\n  reactHotLoader.register(path, \"path\", \"/Users/maurosala/Dev/github/krateoplatformops/krateo-dashboard-backend/packages/backend/src/plugins/scaffolder/actions/cloudbees-insiel.ts\");\n  reactHotLoader.register(nunjucks, \"nunjucks\", \"/Users/maurosala/Dev/github/krateoplatformops/krateo-dashboard-backend/packages/backend/src/plugins/scaffolder/actions/cloudbees-insiel.ts\");\n  reactHotLoader.register(createCloudbeesInsielAction, \"createCloudbeesInsielAction\", \"/Users/maurosala/Dev/github/krateoplatformops/krateo-dashboard-backend/packages/backend/src/plugins/scaffolder/actions/cloudbees-insiel.ts\");\n  leaveModule(module);\n})();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcGx1Z2lucy9zY2FmZm9sZGVyL2FjdGlvbnMvY2xvdWRiZWVzLWluc2llbC50cy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJmaWxlOi8vLy9Vc2Vycy9tYXVyb3NhbGEvRGV2L2dpdGh1Yi9rcmF0ZW9wbGF0Zm9ybW9wcy9rcmF0ZW8tZGFzaGJvYXJkLWJhY2tlbmQvcGFja2FnZXMvYmFja2VuZC9zcmMvcGx1Z2lucy9zY2FmZm9sZGVyL2FjdGlvbnMvY2xvdWRiZWVzLWluc2llbC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKCkgeyB2YXIgZW50ZXJNb2R1bGUgPSByZXF1aXJlKCdyZWFjdC1ob3QtbG9hZGVyJykuZW50ZXJNb2R1bGU7IGVudGVyTW9kdWxlICYmIGVudGVyTW9kdWxlKG1vZHVsZSk7IH0pKCk7LypcbiAqIENvcHlyaWdodCAyMDIyIFRoZSBCYWNrc3RhZ2UgQXV0aG9yc1xuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqXG4gKiAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuaW1wb3J0IHsgY3JlYXRlVGVtcGxhdGVBY3Rpb24gfSBmcm9tICdAYmFja3N0YWdlL3BsdWdpbi1zY2FmZm9sZGVyLWJhY2tlbmQnO1xuaW1wb3J0IHsgcmVzb2x2ZVNhZmVDaGlsZFBhdGggfSBmcm9tICdAYmFja3N0YWdlL2JhY2tlbmQtY29tbW9uJztcblxuY29uc3QgZ2l0ID0gcmVxdWlyZSgnaXNvbW9ycGhpYy1naXQnKTtcbmNvbnN0IGh0dHAgPSByZXF1aXJlKCdpc29tb3JwaGljLWdpdC9odHRwL25vZGUnKTtcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG5jb25zdCBudW5qdWNrcyA9IHJlcXVpcmUoJ251bmp1Y2tzJyk7XG5pbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnO1xuaW1wb3J0ICogYXMgaHR0cHMgZnJvbSAnaHR0cHMnO1xuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSAndXVpZCc7XG5cbi8vIGNvbnN0IHV0aWwgPSByZXF1aXJlKCd1dGlsJyk7XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVDbG91ZGJlZXNJbnNpZWxBY3Rpb24gPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB7IGNvbmZpZyB9ID0gb3B0aW9ucztcblxuICByZXR1cm4gY3JlYXRlVGVtcGxhdGVBY3Rpb25cblxuXG5cbih7XG4gICAgaWQ6ICdrcmF0ZW86Y2xvdWRiZWVzLWluc2llbCcsXG4gICAgc2NoZW1hOiB7XG4gICAgICBpbnB1dDoge1xuICAgICAgICByZXF1aXJlZDogWydob3N0JywgJ2NvbXBvbmVudF9pZCcsICdtYXN0ZXJOYW1lJ10sXG4gICAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgaG9zdDoge1xuICAgICAgICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICAgICAgICB0aXRsZTogJ0hvc3QnLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246ICdIb3N0JyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNvbXBvbmVudF9pZDoge1xuICAgICAgICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICAgICAgICB0aXRsZTogJ0NvbXBvbmVudCBJZCcsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogJ0NvbXBvbmVudCBJZCcsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtYXN0ZXJOYW1lOiB7XG4gICAgICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgICAgIHRpdGxlOiAnQ2xvdWRiZWVzIG5vZGUgbmFtZScsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogJ25vZGUgbmFtZScsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBnaXRIdWJVcmw6IHtcbiAgICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgICAgdGl0bGU6ICdHaXRIdWIgVXJsJyxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnR2l0SHViIFVybCcsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfSxcbiAgICBhc3luYyBoYW5kbGVyKGN0eCkge1xuICAgICAgY29uc3QgZnVsbFVybCA9IGBodHRwczovLyR7Y3R4LmlucHV0Lmhvc3R9YDtcbiAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoZnVsbFVybCk7XG4gICAgICBjb25zdCBvd25lciA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdvd25lcicpO1xuICAgICAgY29uc3QgcmVwbyA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdyZXBvJyk7XG4gICAgICBjb25zdCBiYXNlID0gdXJsLm9yaWdpbjtcbiAgICAgIGNvbnN0IHJlcG9VUkwgPSBgJHtiYXNlfS8ke293bmVyfS8ke3JlcG99YDtcblxuICAgICAgY29uc3QgdGVtcGxhdGVVcmwgPSBjdHgudGVtcGxhdGVJbmZvPy5iYXNlVXJsLnJlcGxhY2UoJy90cmVlL21haW4vJywgJycpO1xuXG4gICAgICBjb25zdCB3b3JrRGlyID0gYXdhaXQgY3R4LmNyZWF0ZVRlbXBvcmFyeURpcmVjdG9yeSgpO1xuICAgICAgY29uc3QgY2JEaXIgPSByZXNvbHZlU2FmZUNoaWxkUGF0aCh3b3JrRGlyLCAnY2xvdWRiZWVzJyk7XG5cbiAgICAgIGN0eC5sb2dnZXIuaW5mbyhgQ3JlYXRlZCB0ZW1wb3JhcnkgZGlyZWN0b3J5OiAke3dvcmtEaXJ9YCk7XG4gICAgICBjdHgubG9nZ2VyLmluZm8oYENsb3VkYmVlcyBkaXJlY3Rvcnk6ICR7Y2JEaXJ9YCk7XG5cbiAgICAgIGF3YWl0IGdpdC5jbG9uZSh7XG4gICAgICAgIGZzLFxuICAgICAgICBodHRwLFxuICAgICAgICBkaXI6IHdvcmtEaXIsXG4gICAgICAgIHVybDogdGVtcGxhdGVVcmwsXG4gICAgICAgIG9uQXV0aDogKCkgPT4gKHsgdXNlcm5hbWU6IHByb2Nlc3MuZW52LkdJVEhVQl9UT0tFTiB9KSxcbiAgICAgICAgcmVmOiAnbWFpbicsXG4gICAgICAgIHNpbmdsZUJyYW5jaDogdHJ1ZSxcbiAgICAgICAgZGVwdGg6IDEsXG4gICAgICB9KTtcblxuICAgICAgbnVuanVja3MuY29uZmlndXJlKGNiRGlyLCB7XG4gICAgICAgIG5vQ2FjaGU6IHRydWUsXG4gICAgICAgIGF1dG9lc2NhcGU6IHRydWUsXG4gICAgICAgIHRhZ3M6IHsgdmFyaWFibGVTdGFydDogJyR7eycgfSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBhcHBYbWwgPSBwYXRoLmpvaW4oY2JEaXIsICdhcHAueG1sJyk7XG4gICAgICBjb25zdCBoZWxtWG1sID0gcGF0aC5qb2luKGNiRGlyLCAnaGVsbS1jaGFydC54bWwnKTtcblxuICAgICAgLy8gQXBwXG4gICAgICBjb25zdCBhcHBNb2RpZmllZCA9IG51bmp1Y2tzLnJlbmRlcihhcHBYbWwsIHtcbiAgICAgICAgb3duZXIsXG4gICAgICAgIHJlcG8sXG4gICAgICAgIGdpdEh1YlVybDogY3R4LmlucHV0LmdpdEh1YlVybCxcbiAgICAgICAgZ3VpZDogdXVpZHY0KCksXG4gICAgICB9KTtcbiAgICAgIGZzLndyaXRlRmlsZVN5bmMoYXBwWG1sLCBhcHBNb2RpZmllZCwgeyBlbmNvZGluZzogJ3V0Zi04JyB9KTtcbiAgICAgIGN0eC5sb2dnZXIuaW5mbyhgQ3JlYXRlZCBhcHAueG1sYCk7XG5cbiAgICAgIC8vIEhlbG0gQ2hhcnRcbiAgICAgIGNvbnN0IGhlbG1Nb2RpZmllZCA9IG51bmp1Y2tzLnJlbmRlcihoZWxtWG1sLCB7XG4gICAgICAgIG93bmVyLFxuICAgICAgICBnaXRIdWJVcmw6IGN0eC5pbnB1dC5naXRIdWJVcmwsXG4gICAgICAgIHJlcG86IGAke3JlcG99LWhjYCxcbiAgICAgICAgZ3VpZDogdXVpZHY0KCksXG4gICAgICB9KTtcbiAgICAgIGZzLndyaXRlRmlsZVN5bmMoaGVsbVhtbCwgaGVsbU1vZGlmaWVkLCB7IGVuY29kaW5nOiAndXRmLTgnIH0pO1xuICAgICAgY3R4LmxvZ2dlci5pbmZvKGBDcmVhdGVkIGhlbG0tY2hhcnQueG1sYCk7XG5cbiAgICAgIC8vIGNhbGxzXG4gICAgICBjb25zdCBheGlvc0luc3RhbmNlID0gYXhpb3MuY3JlYXRlKHtcbiAgICAgICAgaHR0cHNBZ2VudDogbmV3IGh0dHBzLkFnZW50KHtcbiAgICAgICAgICByZWplY3RVbmF1dGhvcml6ZWQ6IGZhbHNlLFxuICAgICAgICB9KSxcbiAgICAgIH0pO1xuXG4gICAgICBjb25zdCBpbnN0YW5jZXMgPSBjb25maWcuZ2V0KCdqZW5raW5zLmluc3RhbmNlcycpO1xuICAgICAgY29uc3QgY2IgPSBpbnN0YW5jZXMuZmluZChpID0+IGkubmFtZSA9PT0gY3R4LmlucHV0Lm1hc3Rlck5hbWUpO1xuXG4gICAgICBjb25zdCB0b2tlbiA9IGAke2NiLnVzZXJuYW1lfToke2NiLmFwaUtleX1gO1xuICAgICAgLy8gYXBwXG4gICAgICAvLyAgZGF0YTogQnVmZmVyLmZyb20oZnMucmVhZEZpbGVTeW5jKGFwcFhtbCkpLFxuXG4gICAgICBjdHgubG9nZ2VyLmluZm8oXG4gICAgICAgIGAke0pTT04uc3RyaW5naWZ5KFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIEFjY2VwdDogJyovKicsXG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogYHRleHQveG1sYCxcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCYXNpYyAke0J1ZmZlci5mcm9tKHRva2VuKS50b1N0cmluZygnYmFzZTY0Jyl9YCxcbiAgICAgICAgICB9LFxuICAgICAgICAgIG51bGwsXG4gICAgICAgICAgNCxcbiAgICAgICAgKX1gLFxuICAgICAgKTtcblxuICAgICAgY3R4LmxvZ2dlci5pbmZvKGB0b2tlbjogJHt0b2tlbn1gKTtcbiAgICAgIGN0eC5sb2dnZXIuaW5mbyhcbiAgICAgICAgYHVybDogJHtjYi5iYXNlVXJsfS9jcmVhdGVJdGVtP25hbWU9JHtjdHguaW5wdXQuY29tcG9uZW50X2lkfWAsXG4gICAgICApO1xuICAgICAgYXdhaXQgYXhpb3NJbnN0YW5jZSh7XG4gICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgICB1cmw6IGAke2NiLmJhc2VVcmx9L2NyZWF0ZUl0ZW0/bmFtZT0ke2N0eC5pbnB1dC5jb21wb25lbnRfaWR9YCxcbiAgICAgICAgZGF0YTogQnVmZmVyLmZyb20oZnMucmVhZEZpbGVTeW5jKGFwcFhtbCkpLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgQWNjZXB0OiAnKi8qJyxcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogYHRleHQveG1sYCxcbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmFzaWMgJHtCdWZmZXIuZnJvbSh0b2tlbikudG9TdHJpbmcoJ2Jhc2U2NCcpfWAsXG4gICAgICAgIH0sXG4gICAgICB9KTtcbiAgICAgIGN0eC5sb2dnZXIuaW5mbyhgQXBwIHBpcGVsaW5lIGNyZWF0ZWRgKTtcbiAgICAgIC8vIGhlbG1cbiAgICAgIGF3YWl0IGF4aW9zSW5zdGFuY2Uoe1xuICAgICAgICBtZXRob2Q6ICdwb3N0JyxcbiAgICAgICAgdXJsOiBgJHtjYi5iYXNlVXJsfS9jcmVhdGVJdGVtP25hbWU9JHtjdHguaW5wdXQuY29tcG9uZW50X2lkfS1oY2AsXG4gICAgICAgIGRhdGE6IEJ1ZmZlci5mcm9tKGZzLnJlYWRGaWxlU3luYyhoZWxtWG1sKSksXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBBY2NlcHQ6ICcqLyonLFxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiBgdGV4dC94bWxgLFxuICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCYXNpYyAke0J1ZmZlci5mcm9tKHRva2VuKS50b1N0cmluZygnYmFzZTY0Jyl9YCxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuICAgICAgY3R4LmxvZ2dlci5pbmZvKGBIZWxtIENoYXJ0IHBpcGVsaW5lIGNyZWF0ZWRgKTtcblxuICAgICAgY3R4LmxvZ2dlci5pbmZvKGBBbGwgZG9uZSBzdWNjZXNzZnVsbHkhYCk7XG4gICAgfSxcbiAgfSk7XG59O1xuXG47KGZ1bmN0aW9uICgpIHtcbiAgdmFyIHJlYWN0SG90TG9hZGVyID0gcmVxdWlyZSgncmVhY3QtaG90LWxvYWRlcicpLmRlZmF1bHQ7XG4gIHZhciBsZWF2ZU1vZHVsZSA9IHJlcXVpcmUoJ3JlYWN0LWhvdC1sb2FkZXInKS5sZWF2ZU1vZHVsZTtcbiAgaWYgKCFyZWFjdEhvdExvYWRlcikge1xuICAgIHJldHVybjtcbiAgfVxuICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihnaXQsIFwiZ2l0XCIsIFwiL1VzZXJzL21hdXJvc2FsYS9EZXYvZ2l0aHViL2tyYXRlb3BsYXRmb3Jtb3BzL2tyYXRlby1kYXNoYm9hcmQtYmFja2VuZC9wYWNrYWdlcy9iYWNrZW5kL3NyYy9wbHVnaW5zL3NjYWZmb2xkZXIvYWN0aW9ucy9jbG91ZGJlZXMtaW5zaWVsLnRzXCIpO1xuICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihodHRwLCBcImh0dHBcIiwgXCIvVXNlcnMvbWF1cm9zYWxhL0Rldi9naXRodWIva3JhdGVvcGxhdGZvcm1vcHMva3JhdGVvLWRhc2hib2FyZC1iYWNrZW5kL3BhY2thZ2VzL2JhY2tlbmQvc3JjL3BsdWdpbnMvc2NhZmZvbGRlci9hY3Rpb25zL2Nsb3VkYmVlcy1pbnNpZWwudHNcIik7XG4gIHJlYWN0SG90TG9hZGVyLnJlZ2lzdGVyKGZzLCBcImZzXCIsIFwiL1VzZXJzL21hdXJvc2FsYS9EZXYvZ2l0aHViL2tyYXRlb3BsYXRmb3Jtb3BzL2tyYXRlby1kYXNoYm9hcmQtYmFja2VuZC9wYWNrYWdlcy9iYWNrZW5kL3NyYy9wbHVnaW5zL3NjYWZmb2xkZXIvYWN0aW9ucy9jbG91ZGJlZXMtaW5zaWVsLnRzXCIpO1xuICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihwYXRoLCBcInBhdGhcIiwgXCIvVXNlcnMvbWF1cm9zYWxhL0Rldi9naXRodWIva3JhdGVvcGxhdGZvcm1vcHMva3JhdGVvLWRhc2hib2FyZC1iYWNrZW5kL3BhY2thZ2VzL2JhY2tlbmQvc3JjL3BsdWdpbnMvc2NhZmZvbGRlci9hY3Rpb25zL2Nsb3VkYmVlcy1pbnNpZWwudHNcIik7XG4gIHJlYWN0SG90TG9hZGVyLnJlZ2lzdGVyKG51bmp1Y2tzLCBcIm51bmp1Y2tzXCIsIFwiL1VzZXJzL21hdXJvc2FsYS9EZXYvZ2l0aHViL2tyYXRlb3BsYXRmb3Jtb3BzL2tyYXRlby1kYXNoYm9hcmQtYmFja2VuZC9wYWNrYWdlcy9iYWNrZW5kL3NyYy9wbHVnaW5zL3NjYWZmb2xkZXIvYWN0aW9ucy9jbG91ZGJlZXMtaW5zaWVsLnRzXCIpO1xuICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihjcmVhdGVDbG91ZGJlZXNJbnNpZWxBY3Rpb24sIFwiY3JlYXRlQ2xvdWRiZWVzSW5zaWVsQWN0aW9uXCIsIFwiL1VzZXJzL21hdXJvc2FsYS9EZXYvZ2l0aHViL2tyYXRlb3BsYXRmb3Jtb3BzL2tyYXRlby1kYXNoYm9hcmQtYmFja2VuZC9wYWNrYWdlcy9iYWNrZW5kL3NyYy9wbHVnaW5zL3NjYWZmb2xkZXIvYWN0aW9ucy9jbG91ZGJlZXMtaW5zaWVsLnRzXCIpO1xuICBsZWF2ZU1vZHVsZShtb2R1bGUpO1xufSkoKTsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/plugins/scaffolder/actions/cloudbees-insiel.ts\n");

/***/ }),

/***/ "./src/plugins/scaffolder/actions/keptn-insiel.ts":
/*!********************************************************!*\
  !*** ./src/plugins/scaffolder/actions/keptn-insiel.ts ***!
  \********************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"createKeptnProjectInsielAction\": () => (/* binding */ createKeptnProjectInsielAction)\n/* harmony export */ });\n/* harmony import */ var _backstage_plugin_scaffolder_backend__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @backstage/plugin-scaffolder-backend */ \"../../plugins/scaffolder-backend/src/index.ts\");\n/* harmony import */ var _backstage_backend_common__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @backstage/backend-common */ \"../backend-common/src/index.ts\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! axios */ \"axios\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var https__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! https */ \"https\");\n/* harmony import */ var https__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(https__WEBPACK_IMPORTED_MODULE_3__);\n/* module decorator */ module = __webpack_require__.hmd(module);\n(function () { var enterModule = (__webpack_require__(/*! react-hot-loader */ \"react-hot-loader\").enterModule); enterModule && enterModule(module); })();/*\n * Copyright 2022 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\nconst git = __webpack_require__(/*! isomorphic-git */ \"isomorphic-git?7761\");\nconst http = __webpack_require__(/*! isomorphic-git/http/node */ \"isomorphic-git/http/node?5755\");\nconst fs = __webpack_require__(/*! fs */ \"fs\");\nconst path = __webpack_require__(/*! path */ \"path\");\nconst util = __webpack_require__(/*! util */ \"util\");\nconst exec = util.promisify((__webpack_require__(/*! child_process */ \"child_process\").exec));\n\n\n\nconst createKeptnProjectInsielAction = (options) => {\n  const { config } = options;\n\n  return (0,_backstage_plugin_scaffolder_backend__WEBPACK_IMPORTED_MODULE_0__.createTemplateAction)({\n    id: 'krateo:keptn-insiel',\n    schema: {\n      input: {\n        required: ['host', 'component_id'],\n        type: 'object',\n        properties: {\n          host: {\n            type: 'string',\n            title: 'Host',\n            description: 'Host',\n          },\n          component_id: {\n            type: 'string',\n            title: 'Component Id',\n            description: 'Component Id',\n          },\n        },\n      },\n    },\n    async handler(ctx) {\n      const fullUrl = `https://${ctx.input.host}`;\n      const url = new URL(fullUrl);\n      const owner = url.searchParams.get('owner');\n      const repo = url.searchParams.get('repo');\n      const base = url.origin;\n      const repoURL = `${base}/${owner}/${repo}`;\n\n      const templateUrl = ctx.templateInfo?.baseUrl.replace('/tree/main/', '');\n\n      const workDir = await ctx.createTemporaryDirectory();\n      const projectDir = (0,_backstage_backend_common__WEBPACK_IMPORTED_MODULE_1__.resolveSafeChildPath)(workDir, 'project');\n\n      await git.clone({\n        fs,\n        http,\n        dir: workDir,\n        url: templateUrl,\n        onAuth: () => ({ username: process.env.GITHUB_TOKEN }),\n        ref: 'main',\n        singleBranch: true,\n        depth: 1,\n      });\n\n      // get keptn api\n      // const proxy = config.get('proxy');\n      // const target = proxy['/keptn-api'].target.replace('api/v1', 'api/controlPlane/v1');\n      const target = process.env.KEPTN_SHIPYARD_URL;\n\n      const axiosInstance = axios__WEBPACK_IMPORTED_MODULE_2___default().create({\n        httpsAgent: new https__WEBPACK_IMPORTED_MODULE_3__.Agent({\n          rejectUnauthorized: false,\n        }),\n        validateStatus: status => {\n          return status < 400;\n        },\n      });\n\n      const prjName = ctx.input.component_id.replace(/\\s+/g, '-');\n\n      ctx.logger.info(`RepoUrl: ${repoURL}`);\n      ctx.logger.info(`Target: ${target}`);\n\n      const headers = {\n        'Content-Type': `application/json`,\n        'x-token': `${process.env.KEPTN_API_TOKEN}`,\n      };\n      const projectData = {\n        gitRemoteURL: `${repoURL}-keptn`,\n        gitToken: process.env.GITHUB_TOKEN,\n        gitUser: owner,\n        name: prjName,\n        shipyard: Buffer.from(\n          fs.readFileSync(path.join(projectDir, 'shipyard.yaml')),\n        ).toString('base64'),\n      };\n      const serviceData = {\n        serviceName: `${prjName}`,\n      };\n      const projectUrl = `${target}/project`;\n      const serviceUrl = `${target}/project/${prjName}/service`;\n\n      ctx.logger.info(`Headers: ${JSON.stringify(headers, null, 4)}`);\n\n      ctx.logger.info(`Creating Project`);\n      ctx.logger.info(`Url: ${projectUrl}`);\n      ctx.logger.info(`Data: ${JSON.stringify(projectData, null, 4)}`);\n      await axiosInstance({\n        method: 'post',\n        url: projectUrl,\n        data: projectData,\n        headers,\n      })\n        .then(async () => {\n          ctx.logger.info(`✅ Project created`);\n\n          // create service\n          ctx.logger.info(`Creating Service`);\n          ctx.logger.info(`Url: ${serviceUrl}`);\n          ctx.logger.info(`Data: ${JSON.stringify(serviceData, null, 4)}`);\n          await axiosInstance({\n            method: 'post',\n            url: serviceUrl,\n            data: serviceData,\n            headers,\n          })\n            .then(() => {\n              ctx.logger.info(`✅ Service created`);\n              ctx.logger.info(`All done successfully! 👍`);\n            })\n            .catch(error => {\n              ctx.logger.error(`❌ Error creating service: ${error}`);\n            });\n        })\n        .catch(error => {\n          ctx.logger.error(`❌ Error creating project: ${error}`);\n        });\n    },\n  });\n};\n\n;(function () {\n  var reactHotLoader = (__webpack_require__(/*! react-hot-loader */ \"react-hot-loader\")[\"default\"]);\n  var leaveModule = (__webpack_require__(/*! react-hot-loader */ \"react-hot-loader\").leaveModule);\n  if (!reactHotLoader) {\n    return;\n  }\n  reactHotLoader.register(git, \"git\", \"/Users/maurosala/Dev/github/krateoplatformops/krateo-dashboard-backend/packages/backend/src/plugins/scaffolder/actions/keptn-insiel.ts\");\n  reactHotLoader.register(http, \"http\", \"/Users/maurosala/Dev/github/krateoplatformops/krateo-dashboard-backend/packages/backend/src/plugins/scaffolder/actions/keptn-insiel.ts\");\n  reactHotLoader.register(fs, \"fs\", \"/Users/maurosala/Dev/github/krateoplatformops/krateo-dashboard-backend/packages/backend/src/plugins/scaffolder/actions/keptn-insiel.ts\");\n  reactHotLoader.register(path, \"path\", \"/Users/maurosala/Dev/github/krateoplatformops/krateo-dashboard-backend/packages/backend/src/plugins/scaffolder/actions/keptn-insiel.ts\");\n  reactHotLoader.register(util, \"util\", \"/Users/maurosala/Dev/github/krateoplatformops/krateo-dashboard-backend/packages/backend/src/plugins/scaffolder/actions/keptn-insiel.ts\");\n  reactHotLoader.register(exec, \"exec\", \"/Users/maurosala/Dev/github/krateoplatformops/krateo-dashboard-backend/packages/backend/src/plugins/scaffolder/actions/keptn-insiel.ts\");\n  reactHotLoader.register(createKeptnProjectInsielAction, \"createKeptnProjectInsielAction\", \"/Users/maurosala/Dev/github/krateoplatformops/krateo-dashboard-backend/packages/backend/src/plugins/scaffolder/actions/keptn-insiel.ts\");\n  leaveModule(module);\n})();//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvcGx1Z2lucy9zY2FmZm9sZGVyL2FjdGlvbnMva2VwdG4taW5zaWVsLnRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJmaWxlOi8vLy9Vc2Vycy9tYXVyb3NhbGEvRGV2L2dpdGh1Yi9rcmF0ZW9wbGF0Zm9ybW9wcy9rcmF0ZW8tZGFzaGJvYXJkLWJhY2tlbmQvcGFja2FnZXMvYmFja2VuZC9zcmMvcGx1Z2lucy9zY2FmZm9sZGVyL2FjdGlvbnMva2VwdG4taW5zaWVsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoKSB7IHZhciBlbnRlck1vZHVsZSA9IHJlcXVpcmUoJ3JlYWN0LWhvdC1sb2FkZXInKS5lbnRlck1vZHVsZTsgZW50ZXJNb2R1bGUgJiYgZW50ZXJNb2R1bGUobW9kdWxlKTsgfSkoKTsvKlxuICogQ29weXJpZ2h0IDIwMjIgVGhlIEJhY2tzdGFnZSBBdXRob3JzXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5pbXBvcnQgeyBjcmVhdGVUZW1wbGF0ZUFjdGlvbiB9IGZyb20gJ0BiYWNrc3RhZ2UvcGx1Z2luLXNjYWZmb2xkZXItYmFja2VuZCc7XG5pbXBvcnQgeyByZXNvbHZlU2FmZUNoaWxkUGF0aCB9IGZyb20gJ0BiYWNrc3RhZ2UvYmFja2VuZC1jb21tb24nO1xuY29uc3QgZ2l0ID0gcmVxdWlyZSgnaXNvbW9ycGhpYy1naXQnKTtcbmNvbnN0IGh0dHAgPSByZXF1aXJlKCdpc29tb3JwaGljLWdpdC9odHRwL25vZGUnKTtcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKTtcbmNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XG5jb25zdCB1dGlsID0gcmVxdWlyZSgndXRpbCcpO1xuY29uc3QgZXhlYyA9IHV0aWwucHJvbWlzaWZ5KHJlcXVpcmUoJ2NoaWxkX3Byb2Nlc3MnKS5leGVjKTtcbmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7XG5pbXBvcnQgKiBhcyBodHRwcyBmcm9tICdodHRwcyc7XG5cbmV4cG9ydCBjb25zdCBjcmVhdGVLZXB0blByb2plY3RJbnNpZWxBY3Rpb24gPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB7IGNvbmZpZyB9ID0gb3B0aW9ucztcblxuICByZXR1cm4gY3JlYXRlVGVtcGxhdGVBY3Rpb24oe1xuICAgIGlkOiAna3JhdGVvOmtlcHRuLWluc2llbCcsXG4gICAgc2NoZW1hOiB7XG4gICAgICBpbnB1dDoge1xuICAgICAgICByZXF1aXJlZDogWydob3N0JywgJ2NvbXBvbmVudF9pZCddLFxuICAgICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgIGhvc3Q6IHtcbiAgICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgICAgdGl0bGU6ICdIb3N0JyxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnSG9zdCcsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjb21wb25lbnRfaWQ6IHtcbiAgICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgICAgdGl0bGU6ICdDb21wb25lbnQgSWQnLFxuICAgICAgICAgICAgZGVzY3JpcHRpb246ICdDb21wb25lbnQgSWQnLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH0sXG4gICAgYXN5bmMgaGFuZGxlcihjdHgpIHtcbiAgICAgIGNvbnN0IGZ1bGxVcmwgPSBgaHR0cHM6Ly8ke2N0eC5pbnB1dC5ob3N0fWA7XG4gICAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGZ1bGxVcmwpO1xuICAgICAgY29uc3Qgb3duZXIgPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgnb3duZXInKTtcbiAgICAgIGNvbnN0IHJlcG8gPSB1cmwuc2VhcmNoUGFyYW1zLmdldCgncmVwbycpO1xuICAgICAgY29uc3QgYmFzZSA9IHVybC5vcmlnaW47XG4gICAgICBjb25zdCByZXBvVVJMID0gYCR7YmFzZX0vJHtvd25lcn0vJHtyZXBvfWA7XG5cbiAgICAgIGNvbnN0IHRlbXBsYXRlVXJsID0gY3R4LnRlbXBsYXRlSW5mbz8uYmFzZVVybC5yZXBsYWNlKCcvdHJlZS9tYWluLycsICcnKTtcblxuICAgICAgY29uc3Qgd29ya0RpciA9IGF3YWl0IGN0eC5jcmVhdGVUZW1wb3JhcnlEaXJlY3RvcnkoKTtcbiAgICAgIGNvbnN0IHByb2plY3REaXIgPSByZXNvbHZlU2FmZUNoaWxkUGF0aCh3b3JrRGlyLCAncHJvamVjdCcpO1xuXG4gICAgICBhd2FpdCBnaXQuY2xvbmUoe1xuICAgICAgICBmcyxcbiAgICAgICAgaHR0cCxcbiAgICAgICAgZGlyOiB3b3JrRGlyLFxuICAgICAgICB1cmw6IHRlbXBsYXRlVXJsLFxuICAgICAgICBvbkF1dGg6ICgpID0+ICh7IHVzZXJuYW1lOiBwcm9jZXNzLmVudi5HSVRIVUJfVE9LRU4gfSksXG4gICAgICAgIHJlZjogJ21haW4nLFxuICAgICAgICBzaW5nbGVCcmFuY2g6IHRydWUsXG4gICAgICAgIGRlcHRoOiAxLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIGdldCBrZXB0biBhcGlcbiAgICAgIC8vIGNvbnN0IHByb3h5ID0gY29uZmlnLmdldCgncHJveHknKTtcbiAgICAgIC8vIGNvbnN0IHRhcmdldCA9IHByb3h5Wycva2VwdG4tYXBpJ10udGFyZ2V0LnJlcGxhY2UoJ2FwaS92MScsICdhcGkvY29udHJvbFBsYW5lL3YxJyk7XG4gICAgICBjb25zdCB0YXJnZXQgPSBwcm9jZXNzLmVudi5LRVBUTl9TSElQWUFSRF9VUkw7XG5cbiAgICAgIGNvbnN0IGF4aW9zSW5zdGFuY2UgPSBheGlvcy5jcmVhdGUoe1xuICAgICAgICBodHRwc0FnZW50OiBuZXcgaHR0cHMuQWdlbnQoe1xuICAgICAgICAgIHJlamVjdFVuYXV0aG9yaXplZDogZmFsc2UsXG4gICAgICAgIH0pLFxuICAgICAgICB2YWxpZGF0ZVN0YXR1czogc3RhdHVzID0+IHtcbiAgICAgICAgICByZXR1cm4gc3RhdHVzIDwgNDAwO1xuICAgICAgICB9LFxuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IHByak5hbWUgPSBjdHguaW5wdXQuY29tcG9uZW50X2lkLnJlcGxhY2UoL1xccysvZywgJy0nKTtcblxuICAgICAgY3R4LmxvZ2dlci5pbmZvKGBSZXBvVXJsOiAke3JlcG9VUkx9YCk7XG4gICAgICBjdHgubG9nZ2VyLmluZm8oYFRhcmdldDogJHt0YXJnZXR9YCk7XG5cbiAgICAgIGNvbnN0IGhlYWRlcnMgPSB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiBgYXBwbGljYXRpb24vanNvbmAsXG4gICAgICAgICd4LXRva2VuJzogYCR7cHJvY2Vzcy5lbnYuS0VQVE5fQVBJX1RPS0VOfWAsXG4gICAgICB9O1xuICAgICAgY29uc3QgcHJvamVjdERhdGEgPSB7XG4gICAgICAgIGdpdFJlbW90ZVVSTDogYCR7cmVwb1VSTH0ta2VwdG5gLFxuICAgICAgICBnaXRUb2tlbjogcHJvY2Vzcy5lbnYuR0lUSFVCX1RPS0VOLFxuICAgICAgICBnaXRVc2VyOiBvd25lcixcbiAgICAgICAgbmFtZTogcHJqTmFtZSxcbiAgICAgICAgc2hpcHlhcmQ6IEJ1ZmZlci5mcm9tKFxuICAgICAgICAgIGZzLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4ocHJvamVjdERpciwgJ3NoaXB5YXJkLnlhbWwnKSksXG4gICAgICAgICkudG9TdHJpbmcoJ2Jhc2U2NCcpLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHNlcnZpY2VEYXRhID0ge1xuICAgICAgICBzZXJ2aWNlTmFtZTogYCR7cHJqTmFtZX1gLFxuICAgICAgfTtcbiAgICAgIGNvbnN0IHByb2plY3RVcmwgPSBgJHt0YXJnZXR9L3Byb2plY3RgO1xuICAgICAgY29uc3Qgc2VydmljZVVybCA9IGAke3RhcmdldH0vcHJvamVjdC8ke3Byak5hbWV9L3NlcnZpY2VgO1xuXG4gICAgICBjdHgubG9nZ2VyLmluZm8oYEhlYWRlcnM6ICR7SlNPTi5zdHJpbmdpZnkoaGVhZGVycywgbnVsbCwgNCl9YCk7XG5cbiAgICAgIGN0eC5sb2dnZXIuaW5mbyhgQ3JlYXRpbmcgUHJvamVjdGApO1xuICAgICAgY3R4LmxvZ2dlci5pbmZvKGBVcmw6ICR7cHJvamVjdFVybH1gKTtcbiAgICAgIGN0eC5sb2dnZXIuaW5mbyhgRGF0YTogJHtKU09OLnN0cmluZ2lmeShwcm9qZWN0RGF0YSwgbnVsbCwgNCl9YCk7XG4gICAgICBhd2FpdCBheGlvc0luc3RhbmNlKHtcbiAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgIHVybDogcHJvamVjdFVybCxcbiAgICAgICAgZGF0YTogcHJvamVjdERhdGEsXG4gICAgICAgIGhlYWRlcnMsXG4gICAgICB9KVxuICAgICAgICAudGhlbihhc3luYyAoKSA9PiB7XG4gICAgICAgICAgY3R4LmxvZ2dlci5pbmZvKGDinIUgUHJvamVjdCBjcmVhdGVkYCk7XG5cbiAgICAgICAgICAvLyBjcmVhdGUgc2VydmljZVxuICAgICAgICAgIGN0eC5sb2dnZXIuaW5mbyhgQ3JlYXRpbmcgU2VydmljZWApO1xuICAgICAgICAgIGN0eC5sb2dnZXIuaW5mbyhgVXJsOiAke3NlcnZpY2VVcmx9YCk7XG4gICAgICAgICAgY3R4LmxvZ2dlci5pbmZvKGBEYXRhOiAke0pTT04uc3RyaW5naWZ5KHNlcnZpY2VEYXRhLCBudWxsLCA0KX1gKTtcbiAgICAgICAgICBhd2FpdCBheGlvc0luc3RhbmNlKHtcbiAgICAgICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgICAgICAgdXJsOiBzZXJ2aWNlVXJsLFxuICAgICAgICAgICAgZGF0YTogc2VydmljZURhdGEsXG4gICAgICAgICAgICBoZWFkZXJzLFxuICAgICAgICAgIH0pXG4gICAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICAgIGN0eC5sb2dnZXIuaW5mbyhg4pyFIFNlcnZpY2UgY3JlYXRlZGApO1xuICAgICAgICAgICAgICBjdHgubG9nZ2VyLmluZm8oYEFsbCBkb25lIHN1Y2Nlc3NmdWxseSEg8J+RjWApO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgICAgIGN0eC5sb2dnZXIuZXJyb3IoYOKdjCBFcnJvciBjcmVhdGluZyBzZXJ2aWNlOiAke2Vycm9yfWApO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaChlcnJvciA9PiB7XG4gICAgICAgICAgY3R4LmxvZ2dlci5lcnJvcihg4p2MIEVycm9yIGNyZWF0aW5nIHByb2plY3Q6ICR7ZXJyb3J9YCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG4gIH0pO1xufTtcblxuOyhmdW5jdGlvbiAoKSB7XG4gIHZhciByZWFjdEhvdExvYWRlciA9IHJlcXVpcmUoJ3JlYWN0LWhvdC1sb2FkZXInKS5kZWZhdWx0O1xuICB2YXIgbGVhdmVNb2R1bGUgPSByZXF1aXJlKCdyZWFjdC1ob3QtbG9hZGVyJykubGVhdmVNb2R1bGU7XG4gIGlmICghcmVhY3RIb3RMb2FkZXIpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIoZ2l0LCBcImdpdFwiLCBcIi9Vc2Vycy9tYXVyb3NhbGEvRGV2L2dpdGh1Yi9rcmF0ZW9wbGF0Zm9ybW9wcy9rcmF0ZW8tZGFzaGJvYXJkLWJhY2tlbmQvcGFja2FnZXMvYmFja2VuZC9zcmMvcGx1Z2lucy9zY2FmZm9sZGVyL2FjdGlvbnMva2VwdG4taW5zaWVsLnRzXCIpO1xuICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihodHRwLCBcImh0dHBcIiwgXCIvVXNlcnMvbWF1cm9zYWxhL0Rldi9naXRodWIva3JhdGVvcGxhdGZvcm1vcHMva3JhdGVvLWRhc2hib2FyZC1iYWNrZW5kL3BhY2thZ2VzL2JhY2tlbmQvc3JjL3BsdWdpbnMvc2NhZmZvbGRlci9hY3Rpb25zL2tlcHRuLWluc2llbC50c1wiKTtcbiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIoZnMsIFwiZnNcIiwgXCIvVXNlcnMvbWF1cm9zYWxhL0Rldi9naXRodWIva3JhdGVvcGxhdGZvcm1vcHMva3JhdGVvLWRhc2hib2FyZC1iYWNrZW5kL3BhY2thZ2VzL2JhY2tlbmQvc3JjL3BsdWdpbnMvc2NhZmZvbGRlci9hY3Rpb25zL2tlcHRuLWluc2llbC50c1wiKTtcbiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIocGF0aCwgXCJwYXRoXCIsIFwiL1VzZXJzL21hdXJvc2FsYS9EZXYvZ2l0aHViL2tyYXRlb3BsYXRmb3Jtb3BzL2tyYXRlby1kYXNoYm9hcmQtYmFja2VuZC9wYWNrYWdlcy9iYWNrZW5kL3NyYy9wbHVnaW5zL3NjYWZmb2xkZXIvYWN0aW9ucy9rZXB0bi1pbnNpZWwudHNcIik7XG4gIHJlYWN0SG90TG9hZGVyLnJlZ2lzdGVyKHV0aWwsIFwidXRpbFwiLCBcIi9Vc2Vycy9tYXVyb3NhbGEvRGV2L2dpdGh1Yi9rcmF0ZW9wbGF0Zm9ybW9wcy9rcmF0ZW8tZGFzaGJvYXJkLWJhY2tlbmQvcGFja2FnZXMvYmFja2VuZC9zcmMvcGx1Z2lucy9zY2FmZm9sZGVyL2FjdGlvbnMva2VwdG4taW5zaWVsLnRzXCIpO1xuICByZWFjdEhvdExvYWRlci5yZWdpc3RlcihleGVjLCBcImV4ZWNcIiwgXCIvVXNlcnMvbWF1cm9zYWxhL0Rldi9naXRodWIva3JhdGVvcGxhdGZvcm1vcHMva3JhdGVvLWRhc2hib2FyZC1iYWNrZW5kL3BhY2thZ2VzL2JhY2tlbmQvc3JjL3BsdWdpbnMvc2NhZmZvbGRlci9hY3Rpb25zL2tlcHRuLWluc2llbC50c1wiKTtcbiAgcmVhY3RIb3RMb2FkZXIucmVnaXN0ZXIoY3JlYXRlS2VwdG5Qcm9qZWN0SW5zaWVsQWN0aW9uLCBcImNyZWF0ZUtlcHRuUHJvamVjdEluc2llbEFjdGlvblwiLCBcIi9Vc2Vycy9tYXVyb3NhbGEvRGV2L2dpdGh1Yi9rcmF0ZW9wbGF0Zm9ybW9wcy9rcmF0ZW8tZGFzaGJvYXJkLWJhY2tlbmQvcGFja2FnZXMvYmFja2VuZC9zcmMvcGx1Z2lucy9zY2FmZm9sZGVyL2FjdGlvbnMva2VwdG4taW5zaWVsLnRzXCIpO1xuICBsZWF2ZU1vZHVsZShtb2R1bGUpO1xufSkoKTsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/plugins/scaffolder/actions/keptn-insiel.ts\n");

/***/ })

};
exports.runtime =
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ /* webpack/runtime/getFullHash */
/******/ (() => {
/******/ 	__webpack_require__.h = () => ("32c81fd1ab8a52f886e9")
/******/ })();
/******/ 
/******/ }
;